# iOS 快捷指令：街机 FreePlay 远程切换

用快捷指令在手机上查看当前是否为免费游玩，并一键改为「免费」或「投币」。

---

## 第一步：先准备好你的云端地址

把下面用到的 **「你的云端地址」** 换成实际地址，例如：`http://192.168.1.100:5000` 或 `https://你的域名.com`（不要末尾的斜杠）。

---

## 第二步：在快捷指令里按顺序添加这些操作

### 1. 获取当前 FreePlay 状态

- **操作**：`获取 URL 的内容`
  - **URL**：`你的云端地址/freeplay`
  - **方法**：GET
  - **不选**「显示运行时的运行前询问」等确认项（可选，方便自动运行）

### 2. 从返回的 JSON 里取出 freePlay

- **操作**：`从输入中获取词典`（或「词典」→ 来源选「URL 的内容」）
- 若没有「从输入中获取词典」，可用：
  - **操作**：`词典`
  - **键**：`freePlay`
  - **值**：点「选择变量」→ 选上一步「URL 的内容」→ 再在「词典」里取 `freePlay`（若支持）

更简单的方式：用「文本」+「从文本中获取词典」：

- **操作**：`文本`，内容留空，来源选上一步「URL 的内容」
- **操作**：`从文本中获取词典`，输入选上一步「文本」
- **操作**：`词典值`，词典选上一步结果，键填：`freePlay`  
  → 得到「当前是否 freeplay」的真/假值，后面用「词典值」作为变量。

（若你用的 iOS 版本里「获取 URL 的内容」可以直接解析 JSON，就选「JSON」或「字典」作为「从…获取」的输入，再取 `freePlay`。）

### 3. 根据 freePlay 显示当前状态

- **操作**：`如果`
  - **条件**：`词典值` **是** `true`（或「包含」true）
- **如果为真**：
  - **操作**：`显示结果` 或 `显示通知`
  - 内容：`当前为：免费游玩`
- **否则**：
  - **操作**：`显示结果` 或 `显示通知`
  - 内容：`当前为：投币模式`

（若「词典值」是文本 "true"/"false"，条件可改为：**文本** **是** `true`。）

### 4. 让用户选择要改成哪种

- **操作**：`从菜单中选取`
  - **提示**：`要改为哪种模式？`
  - **选项 1**：`改为免费游玩`
  - **选项 2**：`改为投币模式`

### 5. 根据选择发送 POST 请求

- **操作**：`如果`
  - **条件**：`菜单选中的项目` **是** `改为免费游玩`
- **如果为真**：
  - **操作**：`获取 URL 的内容`
    - **URL**：`你的云端地址/freeplay`
    - **方法**：POST
    - **请求体**：JSON，内容：`{"freePlay": true}`
    - 请求头加：`Content-Type` = `application/json`
  - 下一行加 **操作**：`显示提醒`，内容：`已改为免费游玩`
- **否则**（选的是「改为投币模式」）：
  - **操作**：`获取 URL 的内容`
    - **URL**：`你的云端地址/freeplay`
    - **方法**：POST
    - **请求体**：JSON，内容：`{"freePlay": false}`
    - 请求头：`Content-Type` = `application/json`
  - 下一行加 **操作**：`显示提醒`，内容：`已改为投币模式`

### 6. 结束

- 最后可加 **操作**：`显示结果`，内容：`完成`（可选）。

---

## 流程图概括

```
1. GET /freeplay → 得到 {"freePlay": true/false}
2. 解析 JSON，取 freePlay
3. 若 true → 显示「当前为：免费游玩」
   若 false → 显示「当前为：投币模式」
4. 菜单：「改为免费游玩」|「改为投币模式」
5. 若选免费 → POST /freeplay  Body: {"freePlay": true}  → 显示「已改为免费游玩」
   若选投币 → POST /freeplay  Body: {"freePlay": false} → 显示「已改为投币模式」
```

---

## 注意事项

- **HTTPS**：若云端是 HTTP（如内网 IP），在 iOS「快捷指令」里可能被限制，需在「设置 → 快捷指令 → 允许运行脚本」等权限中允许，或使用 HTTPS 反向代理。
- **同一局域网**：若服务器在内网，手机需和服务器在同一 Wi‑Fi 或能访问该 IP。
- **URL 一致**：所有「你的云端地址」要一致，且不要漏写端口（如 `:5000`）。

按上述步骤在「快捷指令」App 里新建一个快捷指令，运行后会先提示是否为 freeplay，再通过菜单选择改为免费或投币即可。
